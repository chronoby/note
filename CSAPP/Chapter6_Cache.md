# 存储器层次结构

## 编写高速缓存友好的代码

## 高速缓存对程序性能的影响

### 存储器山

- 一个程序从存储系统中度数据的速率称为读吞吐量(read throughput)或读带宽(read bandwidth)
- 存储器的性能不是一个数字就能描述的，它是一座时间和空间局部性的山
- 明智的程序员视图构造他们的程序，使得程序运行在山峰而不是低谷
- 目标为
  - 利用时间局部性，使得频繁使用的字从L1中取出
  - 利用空间局部性，使得尽可能多的字从一个L1高速缓存行中访问到

### 重新排列循环以提高空间局部性

e.g.矩阵乘法

### 在程序中利用局部性

tips:

- 将你的注意力集中在内循环上，大部分计算和内存访问都发生在这里
- 通过按照数据对象存储在内存中的顺序，以步长为1的读数据，从而使你的程序中空间局部性最大
- 一旦从存储器中读入了一个数据对象，就尽可能地使用它，从而使得程序中的时间局部性最大
