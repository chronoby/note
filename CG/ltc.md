# Real-Time Polygonal-Light Shading with Linearly Transformed Cosines

## 摘要

在这篇论文中，我们展示了如何将一个用 3*3 矩阵表示的线性变换应用于球面分布的向量，来生成另一个球面分布，从而推导出一个解析解。用这种思想，我们可以用任意球面分布作为一个基本形状去创造一个带有粗糙、椭圆各向异性和偏移参数的新的球面分布家族。如果原始分布在球面多边形上有一个解析表达式、normalization、积分和重要性采样，那么这些性质可以被这种线性变换分布继承。

通过为原始分布选择一个 clamped cosine，我们得到了一系列分布，并将其称之为线性变换余弦(Linearly Transformed Cosines (LTCs))。它提供了基于物理的 BRDFs 的一个较好的近似，并可以在球面多边形上被解析化积分。我们展示了如何使用在实时多边形光着色中应用这些性质。我们的技术是鲁棒的，快速的，准确的以及易于实现的。

## 1. Introduction

基于物理的着色包括光照等式的计算，比如双向反射分布函数(BRDF)和球面上的光照的乘积的积分。在这边论文中，我们首先关心于多边形光源的着色，意味着我们要计算 BRDF 在球面多边形上的积分。尽管理论上多边形光源是最简单的光照模型之一，但处于以下两个原因，在实时渲染下该问题仍非常具有挑战性：

- 即使是最简单的分布，在球面多边形下积分这种参数化的球面分布仍然是困难的。例如，解析的 Phong-polygon 积分的开销是非常大的，以及球面高斯没有解析解。
- 最先进的基于物理的材质模型不是简单的分布。它们有更复杂的形状。各向异性的拉伸和偏斜需要被表示从而使得材质更加真实。

在 Sec.3，我们会介绍线性变换球面分布(LTSDs)，一种新的球面分布用来解决上述两个问题。我们从一个原始球面分布开始，将由 3*3 矩阵表示的线性变换应用于方向向量。这会生成一个参数化，允许我们修改原始分布的形状，例如粗糙程度、椭圆各向异性和偏移。参数化使得我们可以使用任何球面分布和不同的基本形状去创造一个新的参数化球面分布家族。这种分布的主要特性是他们继承了原始分布的多种性质，例如 normalization，在任意球面多边形上的积分和重要性采样。

在 Sec.4，我们会介绍为原始分布使用一个 clamped cosine来生成一个分布家族，称之为线性变换余弦(Linearly Transformed Cosines (LTCs))。它提供了基于物理的 BRDFs 的一个较好的近似，由于它涵盖了广泛的球面形状种类。更进一步，既然 clamped cosine 分布可以在任意球面多边形解析化积分，LTCs 也可以。

在 Sec.5，我们会展示如何在实时多边形光着色中应用这种性质。

## 2. Related Work

### 多边形光着色
### 球面分布


## 3. 线性变换球面分布

在这一部分，我们将介绍线性变换球面分布。我们将展示如何通过应用一个线性变换于方向向量，使得原始分布被改变形状。我们将定义这种新的分布并讨论它们的性质。

### 3.1定义

**Original Distribution to be Transformed(被变换的原始分布)** $D_0$ 表示了我们用线性变换重新参数化的原始的分布。$D_0$ 的选择控制变换分布的基本形状。

**Linear Transformation(线性变换)** 为了生成一个新的分布 $D$，我们将一个用 3*3 矩阵 $M$ 表示的线性变换应用于原始分布 $D_0$ 的方向向量 $\omega_0$。注意在整篇论文中，我们假定向量为单位向量

**Closed-Form Expression(解析表达式)** LTSD的大小是原始分布 $D_0$ 在原始方向 $\omega_0$ 的大小乘以 solid angle 的变化量

$$
D(\omega) = D_0(\omega_0)\frac{\partial\omega_0}{\partial\omega}
$$

**Shape Invariance(形状不变性)** 分布对于变换的缩放是不变的，因为缩放向量不会改变他们的方向。更进一步，旋转只会改变分布的朝向，而不是他的形状。这是因为球面分布的 Jacobian 是 


**Median Vector(中间向量)**

